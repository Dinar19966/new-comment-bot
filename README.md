üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

2Ô∏è‚É£ –°–æ–∑–¥–∞–π –∏ –∑–∞–ø–æ–ª–Ω–∏ .env —Ñ–∞–π–ª
cp .env.example .env


–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

COMMENT_API_URL ‚Äî URL –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

BAZAR_API_URL ‚Äî –±–∞–∑–æ–≤—ã–π URL Finbazar

PostgreSQL: PG_DB_HOST, PG_DB_PORT, PG_DB_NAME, PG_DB_USER, PG_DB_PASSWORD

Redis: REDIS_HOST, REDIS_PORT

–õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ —Å–µ–∫—Ä–µ—Ç—ã/–∫–ª—é—á–∏ (—Ç–æ–∫–µ–Ω—ã, API –∫–ª—é—á–∏)

3Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ
# development
npm run start

# watch mode
npm run start:dev

# production mode
npm run start:prod

üê≥ Docker –¥–ª—è PostgreSQL –∏ Redis

–°–æ–∑–¥–∞–π docker-compose.yml –¥–ª—è –ø–æ–¥–Ω—è—Ç–∏—è —Ç–æ–ª—å–∫–æ Postgres –∏ Redis:

version: '3.9'
services:
  postgres:
    image: postgres:15-alpine
    container_name: commentbot_postgres
    restart: always
    environment:
      POSTGRES_DB: ${PG_DB_NAME}
      POSTGRES_USER: ${PG_DB_USER}
      POSTGRES_PASSWORD: ${PG_DB_PASSWORD}
    ports:
      - "${PG_DB_PORT}:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    container_name: commentbot_redis
    restart: always
    ports:
      - "${REDIS_PORT}:6379"
    volumes:
      - redis_data:/data

volumes:
  postgres_data:
  redis_data:


–ó–∞–ø—É—Å–∫:

docker-compose up -d

üîó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö
+-------------------+          +-------------------+
|  Finbazar API     |<-------->| AuthService       |
|  (post/comment)   |          | (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏) 
+-------------------+          +-------------------+
                                    |
                                    v
                             +----------------+
                             | Prisma/Postgres|
                             | (—Ö—Ä–∞–Ω–µ–Ω–∏–µ      |
                             | –∞–∫–∫–∞—É–Ω—Ç–æ–≤)     |
                             +----------------+
                                    |
                                    v
                             +----------------+
                             | CommentService |
                             | (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏  |
                             | –æ—Ç–ø—Ä–∞–≤–∫–∞      |
                             | –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤) |
                             +----------------+
                                    |
                                    v
                             +----------------+
                             | Redis          |
                             | (–∫—ç—à: –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ|
                             | –ø–æ—Å—Ç—ã)         |
                             +----------------+

‚ö° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

AuthService: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏, —Ä–µ—Ñ—Ä–µ—à —Ç–æ–∫–µ–Ω–æ–≤, –º–∞—Å—Å–æ–≤–∞—è –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.

CommentService: –≤—ã–±–æ—Ä –ø–æ—Å—Ç–æ–≤, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –ø—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã.

Redis: —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–∞—Ö, —á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.

PostgreSQL: —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤, —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Å—Ç–∞—Ç—É—Å–æ–≤.

–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–∞–∫ –∏ —á–µ—Ä–µ–∑ Docker.

‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Å—å, —á—Ç–æ .env –∑–∞–ø–æ–ª–Ω–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

–î–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ OTP –º–æ–∂–µ—Ç –±—ã—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (1489).

Docker —Å Postgres –∏ Redis –Ω—É–∂–Ω–æ –ø–æ–¥–Ω–∏–º–∞—Ç—å –¥–æ —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

Cron –≤ NestJS –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–∫–µ–Ω—ã –∏ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–ø–æ–∑–∂–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å).